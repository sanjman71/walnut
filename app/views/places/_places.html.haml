- what = nil unless defined?(what)
- tags = [] unless defined?(tags)

- locations.each do |location|
  .prepend-1.letterbox{:class => cycle("shaded", "")}[location]
    %h3.name.margin-bottom-0
      = link_to location.locatable.name, {:controller => 'places', :action => 'show', :id => location}
    %span.street= location.street_address
    %br
    %span.tags.locality= location.locality_tag_list
    %br
    %span.tags.place
      - location.locatable.tags.each do |place_tag|
        - klasses = tags.include?(place_tag.name) ? ["current", "highlight"] : []
        %span.tag{:style => 'font-size: 12px;'}= link_to place_tag, {:what => place_tag.name}, :class => klasses.join(" ")